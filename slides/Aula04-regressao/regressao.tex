\documentclass[landscape,pdftex]{jomislides}

\slidesmag{5} % escala, qto maior maiores serão as letras/figras/etc.

%\centerslidesfalse

\usepackage[latin1]{inputenc}
\usepackage[portuges]{babel}
\usepackage{alltt}
\usepackage{booktabs}

%
% Slides
% ======
%


\begin{document}

%\input{autorHeaders}

\title{Regressão Linear} 
\author{Fabrício Barth}
\institution{}
\date{Outubro de 2020}

\SlideHeader{}
            {}
\SlideFooter{\theslidepartheading $\;$ --- $\;$ \theslideheading}
            {\theslide}

\vpagecolor[white]{white}


\subtitle{}

\maketitle

\begin{Slide}{Dados sobre carros}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/fig01.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Código para plotar o exemplo anterior}
\begin{verbatim}
data(cars)

plot(cars$dist ~ cars$speed, pch=19, lwd=2, 
     xlab="Velocidade", ylab="Distância", 
     main="Relação entre velocidade e distância 
     para parar um carro")
\end{verbatim}
\end{Slide}


\begin{Slide}{Relacões entre variáveis}
\begin{itemize}
\item Será que existe relação entre a distância com que um carro
  consegue parar e a velocidade com que ele estava no momento da
  freada?
\item Métodos de regressão tentam identificar se existe uma relação
  entre a variável dependente (o valor que precisa ser predito) e a
  variável independente.
\item Distância = variável dependente
\item Velocidade = variável independente
\end{itemize}
\end{Slide}

\begin{Slide}{Definindo linhas}
\begin{itemize}
\item Uma linha pode ser definida na forma de $y = \alpha + \beta \times x$
\item onde $x$ é a variável independente e $y$ a variável dependente.
\item $b$ indica quanto a linha cresce a cada incremento de $x$.
\item A variável $\alpha$ indica o valor de $y$ quando $x = 0$.
\end{itemize}
\end{Slide}


\begin{Slide}{Definindo modelos de regressão linear}
\begin{itemize}
\item O objetivo de um algoritmo que cria este tipo de função é definir
  valores para $\alpha$ e $\beta$ de tal maneira que a linha consiga
  representar o conjunto de dados. 
\item Esta linha pode não representar o conjunto de dados
  perfeitamente. Portanto, é necessário calcular o erro de alguma forma.
\end{itemize}
\end{Slide}


\begin{Slide}{$distancia = 42.3 + 0 \times velocidade$}
É uma função válida. Mas é uma função boa?
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/fig02.png}}
\end{figure}
\end{Slide}

\begin{Slide}{Erro de $distancia = 42.3 + 0 \times velocidade$}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/fig02_anotada.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Determinando o valor de $\alpha$ e $\beta$ em uma
    regressão linear simples}
\begin{itemize}
\item Para estimar os melhores valores para $\alpha$ e
  $\beta$ é utilizado método chamado de \textbf{ordinary least squares
    (OLS)}. 
\item Com este método, os valores de $\alpha$ e $\beta$ são escolhidos
  para minimizar a soma dos erros ao quadrado, ou seja, a distância
  vertical entre o valor predito e o valor real.
\end{itemize}

\begin{equation}
erro = \sum{(y_{i} - \hat{y}_{i})^{2}}
\end{equation}

onde, $y_{i}$ é o valor real e $\hat{y}_{i}$ é o valor predito.

\end{Slide}


\begin{Slide}{Uma função com um erro menor}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/fig03.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Código em $R$ para o slide anterior}
\begin{verbatim}
model <- lm(dist ~ speed, data=cars)
plot(cars$dist ~ cars$speed, pch=19, lwd=2, 
     xlab="Velocidade", ylab="Distância", 
     main="Relação entre velocidade e distância 
     para parar um carro")
abline(model, col="red", lwd=3)
\end{verbatim}
\end{Slide}


\begin{Slide}{Regressão linear múltipla}
\begin{equation}
y = \alpha + \beta_{1} \times x_{1} + \beta_{2} \times x_{2} + \cdots
+ \beta_{i} \times x_{i} + e
\end{equation}
Podemos utilizar uma equação compactada:
\begin{equation}
Y = X \times {\rm \beta} + e 
\end{equation}
\end{Slide}


\begin{Slide}{Regressão linear múltipla}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/regressaoMult.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Regressão linear múltipla}
Agora o objetivo é resolver $\hat{{\rm \beta}}$:

\begin{equation}
{\rm \beta} = (X^{T}X)^{-1} X^{T}Y
\end{equation}

onde:

\begin{itemize}
	\item $X^{T}$ é matriz transposta de $X$, e;
	\item $X^{-1}$ a matriz inversa de $X$.
\end{itemize}
\end{Slide}


\begin{Slide}{Implementação em R}
\begin{verbatim}
reg <- function(x,y){
  x <- as.matrix(x)
  x <- cbind(Intercept = 1, x)
  solve(t(x) %*% x) %*% t(x) %*% y
}
\end{verbatim}
onde: \texttt{solve()} retorna a matriz inversa, \texttt{t()} calcula a matriz
transposta e \texttt{\%*\%} multiplica duas matrizes.
\end{Slide}

\begin{Slide}{Encontrando os coeficientes para o problema do carro}
\begin{verbatim}
reg(y = cars$dist, x = cars$speed)
\end{verbatim}
deve retornar os mesmos valores de coeficientes que
\begin{verbatim}
model <- lm(dist ~ speed, data=cars)
\end{verbatim}
\end{Slide}

\begin{Slide}{Exemplo de regressão linear simples usando $lm$}
\begin{verbatim}
> model <- lm(dist ~ speed, data=cars)
> model

Call:
lm(formula = dist ~ speed, data = cars)

Coefficients:
(Intercept)        speed  
    -17.579        3.932 
\end{verbatim}
\end{Slide}

\begin{Slide}{Exemplo de regressão linear múltipla}
\begin{verbatim}
data(airquality)
help(airquality)
head(airquality)
\end{verbatim}
\end{Slide}

\begin{Slide}{Exemplo de regressão linear múltipla}
\begin{verbatim}
> head(airquality)
  Ozone Solar.R Wind Temp Month Day
1    41     190  7.4   67     5   1
2    36     118  8.0   72     5   2
3    12     149 12.6   74     5   3
4    18     313 11.5   62     5   4
5    NA      NA 14.3   56     5   5
6    28      NA 14.9   66     5   6
\end{verbatim}
\end{Slide}

\begin{Slide}{Exemplo de regressão linear múltipla}
\begin{verbatim}
> modelAirQuality <- lm(Ozone ~ Solar.R + Wind + 
  Temp, data=airquality)
> modelAirQuality

Call:
lm(formula = Ozone ~ Solar.R + Wind + Temp, 
   data = airquality)

Coefficients:
(Intercept)      Solar.R         Wind         Temp  
  -64.34208      0.05982     -3.33359      1.65209
\end{verbatim}
\end{Slide}


\begin{Slide}{Analisando os dados}
\begin{verbatim}
png(filename="../figuras/pairsNY.png", width=600, 
    height=400)
pairs(airquality[1:4])
dev.off()
library(psych)
png(filename="../figuras/pairsPanelNY.png", 
    width=600, height=400)
pairs.panels(airquality[1:4])
dev.off()
\end{verbatim}
\end{Slide}


\begin{Slide}{Correlação entre atributos}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/pairsNY.png}}
\end{figure}
\end{Slide}

\begin{Slide}{Correlação entre atributos}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/pairsPanelNY.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Avaliando o modelo}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/modelAir.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Avaliando o modelo}
\begin{enumerate}
\item Fornece um resumo sobre os erros do modelo. Um resíduo é igual
  ao valor verdadeiro menos o valor predito. O valor máximo do resíduo
  no problema anterior é 95.619. Isto significa que o modelo substima o valor de Ozônio de
  pelo menos um dia em 95.619. Por outro lado, 50\% dos erros ficam
  entre os valores do primeiro e terceiro quartis, ou seja, o modelo
  super-estima em 14.219 e sub-estima em 10.097.

\newpage

\item As estrelas ($***$) indicam o poder de predição de cada atributo
  no modelo. Para fins práticos, considera-se que um atributo é
  estatisticamente significante quando o nível de significância é
  menor ou igual a $0.05$. Se o modelo possui poucos atributos
  estatisticamente significantes então deve-se considerar outros
  modelos para predizer a variável de interesse.

\newpage

\item O \textit{Multiple R-squared} (também chamado como coeficiente
  de determinação) fornece uma medida de quão bem o modelo como um
  todo explica os valores da variável dependente. É similar ao
  coeficiente de correlação, onde quanto mais próximo de $1.0$, melhor
  o modelo explica os dados. O valor de \textit{Adjusted R-squared}
  penaliza modelos com um número maior de variáveis independentes.
\end{enumerate}
\end{Slide}


\begin{Slide}{Avaliando o modelo de forma visual}
\begin{figure}[htbp]
\centering 
\resizebox*{0.8\columnwidth}{0.8\textheight}
{\includegraphics{figuras/residuals.png}}
\end{figure}
\end{Slide}


\begin{Slide}{Exercício}
Qual dos modelos abaixo consegue explicar melhor os dados?
\small
\begin{alltt}
modelAirQuality2 <- lm(Ozone ~ Wind + Temp, 
                 data=airquality)
summary(modelAirQuality2)

modelAirQuality3 <- lm(Ozone ~ Solar.R + Wind + Temp, 
                 data=airquality)
summary(modelAirQuality3)

modelAirQuality4 <- lm(Ozone ~ Solar.R + Wind*Temp, 
                 data=airquality)
summary(modelAirQuality4)

airquality$Solar2 <- airquality$Solar.R^2
airquality$Wind2 <- airquality$Wind^2
airquality$Temp2 <- airquality$Temp^2
modelAirQuality5 <- lm(Ozone ~ Solar.R + Wind + Temp + 
                  Solar2 + Wind2 + Temp2, 
                  data=airquality)
summary(modelAirQuality5)

modelAirQuality6 <- lm(Ozone ~ Wind + Temp + Wind2 + 
                  Temp2, data=airquality)
summary(modelAirQuality6)
\end{alltt}
\end{Slide}


%\begin{Slide}{Melhorando o desempenho do modelo}
%\begin{itemize}
%\item Adicionando relações não lineares.
%\item 
%\end{itemize}
%\end{Slide}



%\begin{Slide}{Material de \textbf{consulta}}
%
%\end{Slide}

\bibliographystyle{plain}
\bibliography{doutorado,mestrado,publicacoes,atech,posDoutorado,vagas}

\end{document}

